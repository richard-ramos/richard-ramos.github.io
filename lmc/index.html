<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.03502e0b7878041eb5a4.css">@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:100;src:local("Montserrat Thin "),local("Montserrat-Thin"),url(/static/montserrat-latin-100-191cc9f50f3b76b9617cb383f19acb7d.woff2) format("woff2"),url(/static/montserrat-latin-100-370318464551d5f25b0f0a78f374faac.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:100;src:local("Montserrat Thin italic"),local("Montserrat-Thinitalic"),url(/static/montserrat-latin-100italic-bdeaeb79db315697bd173a55b097dc18.woff2) format("woff2"),url(/static/montserrat-latin-100italic-ecf7d49386e8f265878e735db34a7c4b.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:200;src:local("Montserrat Extra Light "),local("Montserrat-Extra Light"),url(/static/montserrat-latin-200-85d5ef9db7f2dc6979172a4a3b2c57cb.woff2) format("woff2"),url(/static/montserrat-latin-200-1fc98e126a3d152549240e6244d7e669.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:200;src:local("Montserrat Extra Light italic"),local("Montserrat-Extra Lightitalic"),url(/static/montserrat-latin-200italic-49095760a498d024fe1a85a078850df9.woff2) format("woff2"),url(/static/montserrat-latin-200italic-fe46cf8b9462c820457d3bf537e4057f.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:300;src:local("Montserrat Light "),local("Montserrat-Light"),url(/static/montserrat-latin-300-7c3daf12b706645b5d3710f863a4da04.woff2) format("woff2"),url(/static/montserrat-latin-300-8dc95fab9cf98d02ca8d76e97d3dff60.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:300;src:local("Montserrat Light italic"),local("Montserrat-Lightitalic"),url(/static/montserrat-latin-300italic-f20b178ca2024a5eac8e42e6649db86c.woff2) format("woff2"),url(/static/montserrat-latin-300italic-3fe16939288856e8e828fa2661bf2354.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:400;src:local("Montserrat Regular "),local("Montserrat-Regular"),url(/static/montserrat-latin-400-bc3aa95dca08f5fee5291e34959c27bc.woff2) format("woff2"),url(/static/montserrat-latin-400-8102c4838f9e3d08dad644290a9cb701.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:400;src:local("Montserrat Regular italic"),local("Montserrat-Regularitalic"),url(/static/montserrat-latin-400italic-5cad650422a7184467af5a4d17b264c4.woff2) format("woff2"),url(/static/montserrat-latin-400italic-d191f22af3bb50902b99ac577f81a322.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:500;src:local("Montserrat Medium "),local("Montserrat-Medium"),url(/static/montserrat-latin-500-92d16e458625f4d2c8940f6bdca0ff09.woff2) format("woff2"),url(/static/montserrat-latin-500-8b763220218ffc11c57c84ddb80e7b26.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:500;src:local("Montserrat Medium italic"),local("Montserrat-Mediumitalic"),url(/static/montserrat-latin-500italic-47bfcca6b69d6a9acca7a8bff17193e2.woff2) format("woff2"),url(/static/montserrat-latin-500italic-72c01f753c3940c0b9cb6bf2389caddf.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:600;src:local("Montserrat SemiBold "),local("Montserrat-SemiBold"),url(/static/montserrat-latin-600-6fb1b5623e528e27c18658fecf5ee0ee.woff2) format("woff2"),url(/static/montserrat-latin-600-7c839d15a6f54e7025ba8c0c4b333e8f.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:600;src:local("Montserrat SemiBold italic"),local("Montserrat-SemiBolditalic"),url(/static/montserrat-latin-600italic-60789af1c9338ed1a9546722ec54b4f7.woff2) format("woff2"),url(/static/montserrat-latin-600italic-f3d4de8d0afb19e777c79032ce828e3d.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:700;src:local("Montserrat Bold "),local("Montserrat-Bold"),url(/static/montserrat-latin-700-39d93cf678c740f9f6b2b1cfde34bee3.woff2) format("woff2"),url(/static/montserrat-latin-700-80f10bd382f0df1cd650fec59f3c9394.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:700;src:local("Montserrat Bold italic"),local("Montserrat-Bolditalic"),url(/static/montserrat-latin-700italic-ba136d97b14e82284dd595e257f11c47.woff2) format("woff2"),url(/static/montserrat-latin-700italic-8c98142b425630821139c24bd1698700.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold "),local("Montserrat-ExtraBold"),url(/static/montserrat-latin-800-b7018be9ed6cd94da8b6675b3a468c3b.woff2) format("woff2"),url(/static/montserrat-latin-800-9a9befcf50d64f9d2d19d8b1d1984add.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold italic"),local("Montserrat-ExtraBolditalic"),url(/static/montserrat-latin-800italic-540ffdd223d1a9ad3d4e678e1a23372e.woff2) format("woff2"),url(/static/montserrat-latin-800italic-897086f99f4e1f45e6b1e9368527d0bc.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:900;src:local("Montserrat Black "),local("Montserrat-Black"),url(/static/montserrat-latin-900-58cd789700850375b834e8b6776002eb.woff2) format("woff2"),url(/static/montserrat-latin-900-26d42c9428780e545a540bbb50c84bce.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:900;src:local("Montserrat Black italic"),local("Montserrat-Blackitalic"),url(/static/montserrat-latin-900italic-451157bc8861fe54f523b3669a3def71.woff2) format("woff2"),url(/static/montserrat-latin-900italic-a8ec4957e1c24f5793305763ad9845b3.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:300;src:local("Merriweather Light "),local("Merriweather-Light"),url(/static/merriweather-latin-300-b1158cfcd4aacb9d8fb61625e37af46a.woff2) format("woff2"),url(/static/merriweather-latin-300-cc7de05e166e90320d7d896e0f72a19d.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:300;src:local("Merriweather Light italic"),local("Merriweather-Lightitalic"),url(/static/merriweather-latin-300italic-8fe52a48089d6ebe46db0b8e7cc66263.woff2) format("woff2"),url(/static/merriweather-latin-300italic-e1331f5397c2a673f9d3765138debdb5.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:400;src:local("Merriweather Regular "),local("Merriweather-Regular"),url(/static/merriweather-latin-400-8276fdb72ae8f4714d4e6eba704cc39f.woff2) format("woff2"),url(/static/merriweather-latin-400-69f09800f4f6479d06e44eba837df872.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:400;src:local("Merriweather Regular italic"),local("Merriweather-Regularitalic"),url(/static/merriweather-latin-400italic-3a9be9ea9f7aa4af6de7307df21d9fc0.woff2) format("woff2"),url(/static/merriweather-latin-400italic-d76079ed7541a433a54f79316de086e9.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:700;src:local("Merriweather Bold "),local("Merriweather-Bold"),url(/static/merriweather-latin-700-fa534be7ffa380e39a7f6e03bf9a5e03.woff2) format("woff2"),url(/static/merriweather-latin-700-ba56ea84b8084b7ff9677f50d3cd81bd.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:700;src:local("Merriweather Bold italic"),local("Merriweather-Bolditalic"),url(/static/merriweather-latin-700italic-1ef5edaaa20ae53ea50399884c5e48c6.woff2) format("woff2"),url(/static/merriweather-latin-700italic-534bc9e7ce93c73d73426e46acd78092.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:900;src:local("Merriweather Black "),local("Merriweather-Black"),url(/static/merriweather-latin-900-7528fb70e8a4a82c7305e72ff43ac25f.woff2) format("woff2"),url(/static/merriweather-latin-900-3799b6e2f5ed3fcccf9d7a708d7419fa.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:900;src:local("Merriweather Black italic"),local("Merriweather-Blackitalic"),url(/static/merriweather-latin-900italic-e1b4d2aaa78e12ad84aaf8a56321e4c2.woff2) format("woff2"),url(/static/merriweather-latin-900italic-2ae22f731b3424e8dbb4b37f7ca6e708.woff) format("woff")}@font-face{font-family:Fira Code;font-style:normal;font-display:swap;font-weight:300;src:local("Fira Code Light "),local("Fira Code-Light"),url(/static/fira-code-latin-300-c8738de0a3c4253f6a401478e5a814b3.woff2) format("woff2"),url(/static/fira-code-latin-300-ac896927885dbb76bae2db92bc8cf6ed.woff) format("woff")}@font-face{font-family:Fira Code;font-style:normal;font-display:swap;font-weight:400;src:local("Fira Code Regular "),local("Fira Code-Regular"),url(/static/fira-code-latin-400-32bcbba0e01191632763d63535ddee39.woff2) format("woff2"),url(/static/fira-code-latin-400-56ef019cf851a7441ebe3cff596b85cd.woff) format("woff")}@font-face{font-family:Fira Code;font-style:normal;font-display:swap;font-weight:500;src:local("Fira Code Medium "),local("Fira Code-Medium"),url(/static/fira-code-latin-500-705e674b6cdfb485421d4a2715cefe85.woff2) format("woff2"),url(/static/fira-code-latin-500-13a4f936e4c9bfb4291d3f8e3ab08a54.woff) format("woff")}@font-face{font-family:Fira Code;font-style:normal;font-display:swap;font-weight:600;src:local("Fira Code SemiBold "),local("Fira Code-SemiBold"),url(/static/fira-code-latin-600-a8d1279801aaf2701f59cb5cfefd25bf.woff2) format("woff2"),url(/static/fira-code-latin-600-f9466b460d19ab5bf1121c9ea0ad6039.woff) format("woff")}@font-face{font-family:Fira Code;font-style:normal;font-display:swap;font-weight:700;src:local("Fira Code Bold "),local("Fira Code-Bold"),url(/static/fira-code-latin-700-ab68489103de1ffc456f45551c0ffc9e.woff2) format("woff2"),url(/static/fira-code-latin-700-9ac7ca01d0f582a8be8fad13ba64591a.woff) format("woff")}</style><meta name="generator" content="Gatsby 2.20.12"/><title data-react-helmet="true">Little Man Computer | Hello, I&#x27;m RichΛrd</title><meta data-react-helmet="true" name="description" content="The Little Man Computer (LMC), created by Dr. Stuart Madnick in 1965, simulates a simple von Neumann architecture computer. It is used to…"/><meta data-react-helmet="true" property="og:title" content="Little Man Computer"/><meta data-react-helmet="true" property="og:description" content="The Little Man Computer (LMC), created by Dr. Stuart Madnick in 1965, simulates a simple von Neumann architecture computer. It is used to…"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="RichΛrd"/><meta data-react-helmet="true" name="twitter:title" content="Little Man Computer"/><meta data-react-helmet="true" name="twitter:description" content="The Little Man Computer (LMC), created by Dr. Stuart Madnick in 1965, simulates a simple von Neumann architecture computer. It is used to…"/><link as="script" rel="preload" href="/component---node-modules-gatsby-theme-blog-core-src-templates-post-query-js-d2a146b9abdd88ed6071.js"/><link as="script" rel="preload" href="/799b9e28ec84f08939ab3af68c08e0b6efc8bad3-3109dda61198b9e82a9c.js"/><link as="script" rel="preload" href="/commons-b68ccf6b2b9e9af58b8a.js"/><link as="script" rel="preload" href="/app-f2ca6e7f064d7ce095eb.js"/><link as="script" rel="preload" href="/framework-f0b1095636d7eea85476.js"/><link as="script" rel="preload" href="/styles-72b9aca6a03bf971c27e.js"/><link as="script" rel="preload" href="/webpack-runtime-ffe2303114af638aa29a.js"/><link as="fetch" rel="preload" href="/page-data\lmc\page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data\app-data.json" crossorigin="anonymous"/></head><body><script>(function() { try {
        var mode = localStorage.getItem('theme-ui-color-mode');
        if (!mode) return
        document.body.classList.add('theme-ui-' + mode);
      } catch (e) {} })();</script><div id="___gatsby"><style data-emotion-css="1kocuio">body{--theme-ui-colors-text:var(--theme-ui-colors-text,#111111);--theme-ui-colors-background:var(--theme-ui-colors-background,#fdfdfd);--theme-ui-colors-primary:var(--theme-ui-colors-primary,#1B1F23);--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,#515151);--theme-ui-colors-muted:var(--theme-ui-colors-muted,hsla(0,0%,0%,0.2));--theme-ui-colors-highlight:var(--theme-ui-colors-highlight,#eeeeee);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#373737);--theme-ui-colors-prism-background:var(--theme-ui-colors-prism-background,#fdfdfd);--theme-ui-colors-prism-comment:var(--theme-ui-colors-prism-comment,#809393);--theme-ui-colors-prism-string:var(--theme-ui-colors-prism-string,#addb67);--theme-ui-colors-prism-var:var(--theme-ui-colors-prism-var,#d6deeb);--theme-ui-colors-prism-number:var(--theme-ui-colors-prism-number,#f78c6c);--theme-ui-colors-prism-constant:var(--theme-ui-colors-prism-constant,#82aaff);--theme-ui-colors-prism-punctuation:var(--theme-ui-colors-prism-punctuation,#c792ea);--theme-ui-colors-prism-className:var(--theme-ui-colors-prism-className,#ffc98b);--theme-ui-colors-prism-tag:var(--theme-ui-colors-prism-tag,#ffa7c4);--theme-ui-colors-prism-boolean:var(--theme-ui-colors-prism-boolean,#ff5874);--theme-ui-colors-prism-property:var(--theme-ui-colors-prism-property,#80cbc4);--theme-ui-colors-prism-namespace:var(--theme-ui-colors-prism-namespace,#b2ccd6);--theme-ui-colors-prism-highlight:var(--theme-ui-colors-prism-highlight,hsla(207,95%,15%,1));--theme-ui-colors-prism-color:var(--theme-ui-colors-prism-color,#f00);color:var(--theme-ui-colors-text,var(--theme-ui-colors-text,#111111));background-color:var(--theme-ui-colors-background,var(--theme-ui-colors-background,#fdfdfd));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,rgba(255,255,255,0.86));--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#232129);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#cdcdcd);--theme-ui-colors-secondary:var(--theme-ui-colors-modes-dark-secondary,rgba(255,255,255,0.86));--theme-ui-colors-muted:var(--theme-ui-colors-modes-dark-muted,hsla(0,0%,100%,0.2));--theme-ui-colors-highlight:var(--theme-ui-colors-modes-dark-highlight,#44404e);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#fff);--theme-ui-colors-prism-background:var(--theme-ui-colors-modes-dark-prism-background,#232129);}</style><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion-css="1kluxln">.css-1kluxln{font-family:'Fira Code',monospace;font-size:16px;font-weight:400;line-height:1.75;}</style><div class="css-1kluxln"><header><style data-emotion-css="nvo7eq">.css-nvo7eq{max-width:672px;margin-left:auto;margin-right:auto;padding-left:28px;padding-right:28px;padding-top:56px;}</style><div class="css-nvo7eq"><style data-emotion-css="vvwxvu">.css-vvwxvu{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-bottom:14px;}</style><div class="css-vvwxvu"><style data-emotion-css="y7j6kp">.css-y7j6kp{margin-top:0;margin-bottom:0;font-weight:450;}</style><style data-emotion-css="189yr73">.css-189yr73{padding:0;margin:0;margin-bottom:28px;font-size:23.08319849451542px;font-family:'Fira Code',monospace;line-height:1.1;font-weight:900;margin-top:0;margin-bottom:0;font-weight:450;}</style><p class="css-189yr73"><style data-emotion-css="1m64705">.css-1m64705{box-shadow:none;-webkit-text-decoration:none;text-decoration:none;color:var(--theme-ui-colors-primary,#1B1F23);}</style><style data-emotion-css="1u0ao5r">.css-1u0ao5r{color:var(--theme-ui-colors-primary,#1B1F23);box-shadow:none;-webkit-text-decoration:none;text-decoration:none;color:var(--theme-ui-colors-primary,#1B1F23);}</style><a class="css-1u0ao5r" href="/">Hello, I&#x27;m RichΛrd</a></p><style data-emotion-css="cjhtf6">.css-cjhtf6{color:var(--theme-ui-colors-primary,#1B1F23);}</style><a href="#" class="css-cjhtf6"><style data-emotion-css="cpnst2">.css-cpnst2{pointer-events:none;margin:4px;}</style><img alt="moon" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjwhRE9DVFlQRSBzdmcgIFBVQkxJQyAnLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4nICAnaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkJz48c3ZnIGhlaWdodD0iMzJweCIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMzIgMzI7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCAzMiAzMiIgd2lkdGg9IjMycHgiIHhtbDpzcGFjZT0icHJlc2VydmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxnIGlkPSJMYXllcl8xIi8+PGcgaWQ9Im1vb25feDVGX3N0cm9rZSI+PHBhdGggZD0iTTUuODk1LDkuMTQ4YzAuODQ4LDguOTU5LDgsMTYuMTA5LDE2Ljk1NywxNi45NTNjLTEuOTEsMS4yMTEtNC4xNTIsMS44OTgtNi41LDEuODk4ICAgQzkuNTM5LDI4LDQsMjIuNDYxLDQsMTUuNjQ2QzQsMTMuMjk5LDQuNjg4LDExLjA1OSw1Ljg5NSw5LjE0OCBNMTEuODQ0LDBDNS4wMiwxLjk2OSwwLDguMTg5LDAsMTUuNjQ2QzAsMjQuNjgsNy4zMiwzMiwxNi4zNTIsMzIgICBjNy40NTcsMCwxMy42OC01LjAyMywxNS42NDgtMTEuODQ0Yy0yLjE4LDEuMjU4LTQuNjcyLDIuMDMxLTcuMzY3LDIuMDMxYy04LjE4OCwwLTE0LjgyLTYuNjM5LTE0LjgyLTE0LjgyMiAgIEM5LjgxMiw0LjY3LDEwLjU4NiwyLjE3OCwxMS44NDQsMEwxMS44NDQsMHoiIHN0eWxlPSJmaWxsOiM0RTRFNTA7Ii8+PC9nPjwvc3ZnPg==" width="16" height="16" role="presentation" class="css-cpnst2"/></a></div></div></header><div><style data-emotion-css="17ef8ep">.css-17ef8ep{max-width:672px;margin-left:auto;margin-right:auto;padding-left:28px;padding-right:28px;padding-top:0;padding-bottom:0;}</style><div class="css-17ef8ep"><main><style data-emotion-css="tbuchx">.css-tbuchx{padding:0;margin:0;margin-bottom:28px;font-size:40px;font-family:'Fira Code',monospace;line-height:1.1;font-weight:900;}</style><h1 class="css-tbuchx">Little Man Computer</h1><style data-emotion-css="1qqxfhy">.css-1qqxfhy{font-size:13.32085131842997px;margin-top:-28px;margin-bottom:28px;}</style><style data-emotion-css="1m60b3c">.css-1m60b3c{padding:0;margin:0;margin-bottom:28px;font-size:13.32085131842997px;margin-top:-28px;margin-bottom:28px;}.css-1m60b3c code{font-size:inherit;}</style><p class="css-1m60b3c">April 10, 2020</p><style data-emotion-css="5rlcw3">.css-5rlcw3{padding:0;margin:0;margin-bottom:28px;border:0;border-bottom:1px solid;margin-top:-1px;border-color:var(--theme-ui-colors-muted,hsla(0,0%,0%,0.2));}</style><hr class="css-5rlcw3"/><style data-emotion-css="1mv7wyt">.css-1mv7wyt{padding:0;margin:0;margin-bottom:28px;}.css-1mv7wyt code{font-size:inherit;}</style><p class="css-1mv7wyt">The Little Man Computer (LMC), created by Dr. Stuart Madnick in 1965, simulates a simple von Neumann architecture computer. It is used to explain how a computer works in easy-to-understand terms: Imagine a man in a room, whose job is to fetch instructions, decode and execute them continuously, acting as the control unit of a CPU. This room has an inbox, an outbox, 100 numbered mailboxes, a counter, and a accumulator or calculator that can only do addition and subtraction. The little man - using these tools - must follow these steps:</p><style data-emotion-css="wf0k3i">.css-wf0k3i{padding:0;margin:0;margin-bottom:28px;list-style-position:outside;list-style-image:none;margin-left:28px;}</style><ol class="css-wf0k3i"><style data-emotion-css="ikjsr2">.css-ikjsr2{margin-bottom:14px;padding-left:0;}.css-ikjsr2 ol{margin-top:14px;margin-bottom:14px;margin-left:28px;}.css-ikjsr2 ul{margin-top:14px;margin-bottom:14px;margin-left:28px;}.css-ikjsr2 p{margin-bottom:14px;}.css-ikjsr2 code{font-size:inherit;}</style><li class="css-ikjsr2">Read the number displayed in the Counter (it starts at 0)</li><li class="css-ikjsr2">Go to the mailbox with that same number, look and remember the number that appears on a slip of paper in that mailbox.</li><li class="css-ikjsr2">Push a button to increment the Counter</li><li class="css-ikjsr2">Perform the instruction designated by the number on the slip of paper.</li><li class="css-ikjsr2">Go back to step 1 or halt</li></ol><p class="css-1mv7wyt">There&#x27;s a limited set of instructions that the little man can do:</p><style data-emotion-css="1kcvdi7">.css-1kcvdi7{padding:0;margin:0;margin-bottom:14px;font-size:11px;font-family:'Fira Code',monospace;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;color:var(--theme-ui-colors-text,#111111);background-color:var(--theme-ui-colors-prism-background,#fdfdfd);overflow:auto;border-radius:10px;}.css-1kcvdi7 .attr-name{font-style:italic;}.css-1kcvdi7 .comment{color:var(--theme-ui-colors-prism-comment,#809393);}.css-1kcvdi7 .attr-name,.css-1kcvdi7 .string,.css-1kcvdi7 .url{color:var(--theme-ui-colors-prism-string,#addb67);}.css-1kcvdi7 .variable{color:var(--theme-ui-colors-prism-var,#d6deeb);}.css-1kcvdi7 .number{color:var(--theme-ui-colors-prism-number,#f78c6c);}.css-1kcvdi7 .builtin,.css-1kcvdi7 .char,.css-1kcvdi7 .constant,.css-1kcvdi7 .function{color:var(--theme-ui-colors-prism-constant,#82aaff);}.css-1kcvdi7 .punctuation,.css-1kcvdi7 .selector,.css-1kcvdi7 .doctype{color:var(--theme-ui-colors-prism-punctuation,#c792ea);}.css-1kcvdi7 .class-name{color:var(--theme-ui-colors-prism-className,#ffc98b);}.css-1kcvdi7 .tag,.css-1kcvdi7 .operator,.css-1kcvdi7 .keyword{color:var(--theme-ui-colors-prism-tag,#ffa7c4);}.css-1kcvdi7 .boolean{color:var(--theme-ui-colors-prism-boolean,#ff5874);}.css-1kcvdi7 .property{color:var(--theme-ui-colors-prism-property,#80cbc4);}.css-1kcvdi7 .namespace{color:var(--theme-ui-colors-prism-namespace,#b2ccd6);}</style><style data-emotion-css="1cd8nnu">.css-1cd8nnu{margin-bottom:14px;}</style><div class="css-1cd8nnu"><pre class=" prism-code language- css-1kcvdi7"><div class="token-line"><style data-emotion-css="1baulvz">.css-1baulvz{display:inline-block;}</style><span class="token plain css-1baulvz">+---------+----------+------------------------------------------------------------------------+</span></div><div class="token-line"><span class="token plain css-1baulvz">| Numeric | Mnemonic | Description                                                            |</span></div><div class="token-line"><span class="token plain css-1baulvz">+---------+----------+------------------------------------------------------------------------+</span></div><div class="token-line"><span class="token plain css-1baulvz">| 000     | STOP     | Stops the Computer                                                     |</span></div><div class="token-line"><span class="token plain css-1baulvz">| 1xx     | ADD xx   | Adds the contents of the mailbox xx to the accumulator value           |</span></div><div class="token-line"><span class="token plain css-1baulvz">| 2xx     | SUB xx   | Subtracts the contents of the mailbox xx from the accumulator value    |</span></div><div class="token-line"><span class="token plain css-1baulvz">| 3xx     | STO xx   | Stores the accumulator value into the mailbox xx                       |</span></div><div class="token-line"><span class="token plain css-1baulvz">| 5xx     | LOAD xx  | Replace the accumulator value with the contents of the mailbox xx      |</span></div><div class="token-line"><span class="token plain css-1baulvz">| 6xx     | BRA xx   | Sets the counter to the number xx                                      |</span></div><div class="token-line"><span class="token plain css-1baulvz">| 7xx     | BRZ xx   | If the accumulator value is zero, sets the counter to the number xx    |</span></div><div class="token-line"><span class="token plain css-1baulvz">| 8xx     | BRP xx   | If the accumulator value is greater or equals to 0, then set the       |</span></div><div class="token-line"><span class="token plain css-1baulvz">|         |          | counter to the number xx                                               |</span></div><div class="token-line"><span class="token plain css-1baulvz">| 901     | READ     | Read a number from the inbox and write it into the accumulator         |</span></div><div class="token-line"><span class="token plain css-1baulvz">| 902     | PRINT    | Copy the number in the accumulator onto a slip of paper and place      |</span></div><div class="token-line"><span class="token plain css-1baulvz">|         |          | it into the outbox                                                     |</span></div><div class="token-line"><span class="token plain css-1baulvz">+---------+----------+------------------------------------------------------------------------+</span></div></pre></div><p class="css-1mv7wyt">We will write a small LMC. This write-up assumes you have Rust installed in your machine, if that is not the case, <a href="https://www.rust-lang.org/learn/get-started" class="css-cjhtf6">install it!</a>. </p><style data-emotion-css="1g6orwr">.css-1g6orwr{padding:0;margin:0;margin-bottom:28px;font-size:20px;font-family:'Fira Code',monospace;line-height:1.1;font-weight:900;margin-top:56px;}</style><style data-emotion-css="1i9kc2g">.css-1i9kc2g{pointer-events:painted;padding:0;margin:0;margin-bottom:28px;font-size:20px;font-family:'Fira Code',monospace;line-height:1.1;font-weight:900;margin-top:56px;}.css-1i9kc2g a{visibility:hidden;}.css-1i9kc2g:hover a{visibility:visible;}</style><h2 class="css-1i9kc2g"><style data-emotion-css="bt6h6g">.css-bt6h6g{margin-left:-20px;padding-right:4px;color:var(--theme-ui-colors-primary,#1B1F23);}</style><a href="#undefined" class="css-bt6h6g"><svg viewBox="0 0 16 16" width="16" height="16" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Project setup</h2><p class="css-1mv7wyt">Let&#x27;s start by creating a folder for our project and a new Rust package inside it. </p><div class="css-1cd8nnu"><pre class=" prism-code language- css-1kcvdi7"><div class="token-line"><span class="token plain css-1baulvz">mkdir lmc</span></div><div class="token-line"><span class="token plain css-1baulvz">cd ./lmc</span></div><div class="token-line"><span class="token plain css-1baulvz">cargo init</span></div></pre></div><p class="css-1mv7wyt">This command will generate our project manifest <style data-emotion-css="ttvl72">.css-ttvl72{border-radius:0.3em;color:var(--theme-ui-colors-secondary,#515151);background-color:var(--theme-ui-colors-highlight,#eeeeee);padding-top:0.15em;padding-bottom:0.05em;padding-left:0.2em;padding-right:0.2em;}</style><code class="css-ttvl72">Cargo.toml</code> which contains all the metadata required to compile the project, and the default executable file <code class="css-ttvl72">src/main.rs</code>.</p><div class="css-1cd8nnu"><pre class=" prism-code language- css-1kcvdi7"><div class="token-line"><span class="token plain css-1baulvz">lmc</span></div><div class="token-line"><span class="token plain css-1baulvz">|-- .git</span></div><div class="token-line"><span class="token plain css-1baulvz">|-- .gitignore</span></div><div class="token-line"><span class="token plain css-1baulvz">|-- Cargo.toml</span></div><div class="token-line"><span class="token plain css-1baulvz">|-- src</span></div><div class="token-line"><span class="token plain css-1baulvz">    |-- main.rs</span></div></pre></div><p class="css-1mv7wyt">Executing <code class="css-ttvl72">cargo run</code> will compile and execute the project:</p><div class="css-1cd8nnu"><pre class=" prism-code language- css-1kcvdi7"><div class="token-line"><span class="token plain css-1baulvz">cargo run</span></div><div class="token-line"><span class="token plain css-1baulvz">  Compiling lmc v0.1.0 (/path/to/lmc)</span></div><div class="token-line"><span class="token plain css-1baulvz">  Finished dev [unoptimized + debuginfo] target(s) in 0.50s</span></div><div class="token-line"><span class="token plain css-1baulvz">    Running `target/debug/lmc`</span></div><div class="token-line"><span class="token plain css-1baulvz">Hello world</span></div></pre></div><h2 class="css-1i9kc2g"><a href="#undefined" class="css-bt6h6g"><svg viewBox="0 0 16 16" width="16" height="16" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Reading arguments from the command line</h2><p class="css-1mv7wyt">We need to fill the LMC mailboxes with up to 100 instructions. To indicate our program how whether we will read these instructions from the standard input or a file, we will use a command line flag.</p><p class="css-1mv7wyt">A nice way to do this is through the most popular crate to parse command line arguments: <a href="http://clap.rs" class="css-cjhtf6"><code class="css-ttvl72">clap</code></a>. We need to add this library to our dependencies in the <code class="css-ttvl72">Cargo.toml</code> file.</p><div class="css-1cd8nnu"><pre class="language-toml prism-code language-toml css-1kcvdi7"><div class="token-line"><span class="token plain css-1baulvz">[dependencies]</span></div><div class="token-line"><span class="token plain css-1baulvz">clap = &quot;2.33.0&quot;</span></div></pre></div><p class="css-1mv7wyt">And fetch this dependency and pre-compile it with <code class="css-ttvl72">cargo build</code>.</p><style data-emotion-css="7lbzlp">.css-7lbzlp{width:100%;margin-top:40px;margin-left:0;margin-bottom:40px;position:relative;display:block;}@media screen and (min-width:40em){.css-7lbzlp{width:960px;margin-left:calc(50% - 480px);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}</style><div class="css-7lbzlp"><style data-emotion-css="1iwrzxx">.css-1iwrzxx{width:100vw;margin-left:calc(50% - 50vw);position:-webkit-sticky;position:sticky;top:0;z-index:1;height:50vh;}@media screen and (min-width:40em){.css-1iwrzxx{width:50%;margin-left:0;position:static;top:auto;z-index:auto;height:auto;}}@media screen and (min-width:52em){.css-1iwrzxx{width:100vw;}}@media screen and (min-width:64em){.css-1iwrzxx{width:60%;}}</style><div class="css-1iwrzxx"><div style="height:100%;width:100%"><style data-emotion-css="vba7jp">.css-vba7jp{position:static;width:100%;height:100%;top:auto;border:none;border-color:var(--theme-ui-colors-secondary,#515151);}@media screen and (min-width:40em){.css-vba7jp{position:-webkit-sticky;position:sticky;height:60vh;top:20vh;border:1px solid;}}@media screen and (min-width:52em){.css-vba7jp{position:static;height:100%;top:auto;border:none;}}@media screen and (min-width:64em){.css-vba7jp{position:-webkit-sticky;position:sticky;height:60vh;top:20vh;border:0px solid;}}</style><div class="css-vba7jp"><div style="overflow:auto;height:100%;width:100%"><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><style data-emotion-css="eaflqv">.css-eaflqv{color:var(--theme-ui-colors-text,#111111);background-color:var(--theme-ui-colors-background,#fdfdfd);}.css-eaflqv .token-comment,.css-eaflqv .token-cdata,.css-eaflqv .token-doctype{font-style:italic;}.css-eaflqv .token-builtin,.css-eaflqv .token-changed,.css-eaflqv .token-keyword,.css-eaflqv .token-punctuation,.css-eaflqv .token-operator,.css-eaflqv .token-tag,.css-eaflqv .token-deleted,.css-eaflqv .token-string,.css-eaflqv .token-attr-value,.css-eaflqv .token-char,.css-eaflqv .token-number,.css-eaflqv .token-inserted{color:var(--theme-ui-colors-primary,#1B1F23);}.css-eaflqv .token-line-number{opacity:0.65;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}</style><pre class="cs-content css-eaflqv" style="margin:0;height:100%;overflow:hidden"><style data-emotion-css="eyaae1">.css-eyaae1{color:var(--theme-ui-colors-text,#111111);background-color:var(--theme-ui-colors-background,#fdfdfd);}</style><code class="cs-scaled-content css-eyaae1" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-0"><span class="token-comment">// main.rs</span></div></div><div style="overflow:hidden;opacity:1"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-6"><span class="token-keyword">fn</span><span class="token-plain"> </span><span class="token-function">main</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-punctuation">{</span></div></div><div style="overflow:hidden;transform:translateX(250px);height:0;opacity:0"><div style="display:inline-block" class="cs-line cs-line-12"><span class="token-plain">      </span><span class="token-punctuation">.</span><span class="token-function">help</span><span class="token-punctuation">(</span><span class="token-string">&quot;Indicates that the input is a file path&quot;</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-40"><span class="token-plain">  </span><span class="token-function">println!</span><span class="token-punctuation">(</span><span class="token-string">&quot;Hello, world!&quot;</span><span class="token-punctuation">)</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-41"><span class="token-punctuation">}</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-eaflqv" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-eyaae1" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;opacity:0.3"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;opacity:0.3"><div style="display:inline-block" class="cs-line cs-line-12"><span class="token-plain">      </span><span class="token-punctuation">.</span><span class="token-function">help</span><span class="token-punctuation">(</span><span class="token-string">&quot;Indicates that the input is a file path&quot;</span><span class="token-punctuation">)</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-eaflqv" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-eyaae1" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;opacity:0.3"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;height:100px;opacity:0.3;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-12"><span class="token-plain">      </span><span class="token-punctuation">.</span><span class="token-function">help</span><span class="token-punctuation">(</span><span class="token-string">&quot;Indicates that the input is a file path&quot;</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden;transform:translateX(250px);height:0;opacity:0"><div style="display:inline-block" class="cs-line cs-line-17"><span class="token-plain">  </span><span class="token-keyword">let</span><span class="token-plain"> reader</span><span class="token-punctuation">:</span><span class="token-plain"> Box</span><span class="token-operator">&lt;</span><span class="token-keyword">dyn</span><span class="token-plain"> BufRead</span><span class="token-operator">&gt;</span><span class="token-plain"> </span><span class="token-operator">=</span><span class="token-plain"> </span><span class="token-keyword">match</span><span class="token-plain"> matches</span><span class="token-punctuation">.</span><span class="token-function">value_of</span><span class="token-punctuation">(</span><span class="token-string">&quot;file&quot;</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-punctuation">{</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-eaflqv" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-eyaae1" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;opacity:0.3"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;opacity:0.3"><div style="display:inline-block" class="cs-line cs-line-17"><span class="token-plain">  </span><span class="token-keyword">let</span><span class="token-plain"> reader</span><span class="token-punctuation">:</span><span class="token-plain"> Box</span><span class="token-operator">&lt;</span><span class="token-keyword">dyn</span><span class="token-plain"> BufRead</span><span class="token-operator">&gt;</span><span class="token-plain"> </span><span class="token-operator">=</span><span class="token-plain"> </span><span class="token-keyword">match</span><span class="token-plain"> matches</span><span class="token-punctuation">.</span><span class="token-function">value_of</span><span class="token-punctuation">(</span><span class="token-string">&quot;file&quot;</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-punctuation">{</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-eaflqv" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-eyaae1" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;opacity:0.3"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;opacity:0.3"><div style="display:inline-block" class="cs-line cs-line-17"><span class="token-plain">  </span><span class="token-keyword">let</span><span class="token-plain"> reader</span><span class="token-punctuation">:</span><span class="token-plain"> Box</span><span class="token-operator">&lt;</span><span class="token-keyword">dyn</span><span class="token-plain"> BufRead</span><span class="token-operator">&gt;</span><span class="token-plain"> </span><span class="token-operator">=</span><span class="token-plain"> </span><span class="token-keyword">match</span><span class="token-plain"> matches</span><span class="token-punctuation">.</span><span class="token-function">value_of</span><span class="token-punctuation">(</span><span class="token-string">&quot;file&quot;</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-punctuation">{</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-eaflqv" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-eyaae1" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;opacity:0.3"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;opacity:0.3"><div style="display:inline-block" class="cs-line cs-line-17"><span class="token-plain">  </span><span class="token-keyword">let</span><span class="token-plain"> reader</span><span class="token-punctuation">:</span><span class="token-plain"> Box</span><span class="token-operator">&lt;</span><span class="token-keyword">dyn</span><span class="token-plain"> BufRead</span><span class="token-operator">&gt;</span><span class="token-plain"> </span><span class="token-operator">=</span><span class="token-plain"> </span><span class="token-keyword">match</span><span class="token-plain"> matches</span><span class="token-punctuation">.</span><span class="token-function">value_of</span><span class="token-punctuation">(</span><span class="token-string">&quot;file&quot;</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-punctuation">{</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-eaflqv" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-eyaae1" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;height:100px;opacity:0.3;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;height:100px;opacity:0.3;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-17"><span class="token-plain">  </span><span class="token-keyword">let</span><span class="token-plain"> reader</span><span class="token-punctuation">:</span><span class="token-plain"> Box</span><span class="token-operator">&lt;</span><span class="token-keyword">dyn</span><span class="token-plain"> BufRead</span><span class="token-operator">&gt;</span><span class="token-plain"> </span><span class="token-operator">=</span><span class="token-plain"> </span><span class="token-keyword">match</span><span class="token-plain"> matches</span><span class="token-punctuation">.</span><span class="token-function">value_of</span><span class="token-punctuation">(</span><span class="token-string">&quot;file&quot;</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-punctuation">{</span></div></div><div></div></code></pre></div></div></div></div></div></div><style data-emotion-css="1uvj81">.css-1uvj81{-webkit-flex:1;-ms-flex:1;flex:1;padding-left:0;padding-top:50px;}@media screen and (min-width:40em){.css-1uvj81{padding-left:50px;padding-top:0;}}</style><div class="scroller css-1uvj81"><style data-emotion-css="doiu0q">.css-doiu0q{position:relative;padding:0;min-height:250px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border-left:none;}@media screen and (min-width:40em){.css-doiu0q{padding:0 10px;border-left:3px solid transparent;}}</style><div class="css-doiu0q"><style data-emotion-css="1nroygx">.css-1nroygx{position:absolute;left:-12px;background-color:var(--theme-ui-colors-primary,#1B1F23);}@media screen and (min-width:40em){.css-1nroygx{left:-3px;}}</style><div style="top:0%;bottom:0%;width:3px" class="css-1nroygx"></div><div><p class="css-1mv7wyt">Edit the main function of <code class="css-ttvl72">main.rs</code> file. Currently it only prints &quot;Hello, world!&quot;. Let&#x27;s make it do something more interesting!</p></div></div><div class="css-doiu0q"><div style="top:0%;bottom:100%" class="css-1nroygx"></div><div><p class="css-1mv7wyt">Add the following code to make our program expect an optional flag <code class="css-ttvl72">--file</code>. We can also use <code class="css-ttvl72">-f</code>. If you execute <code class="css-ttvl72">cargo run -- --help</code>, you&#x27;ll see that the <code class="css-ttvl72">clap</code> package displays some hints on what flags are expected.</p></div></div><div class="css-doiu0q"><div style="top:0%;bottom:100%" class="css-1nroygx"></div><div><p class="css-1mv7wyt">The next step is to read the instructions. Depending on the <code class="css-ttvl72">--file</code> flag we will read it from a file, or from the standard input. Start by importing som elements from the packages <code class="css-ttvl72">std::io</code> and <code class="css-ttvl72">std::fs</code>.</p></div></div><div class="css-doiu0q"><div style="top:0%;bottom:100%" class="css-1nroygx"></div><div><p class="css-1mv7wyt">And create a <code class="css-ttvl72">reader</code> variable that will contain a <code class="css-ttvl72">BufRead</code> trait object (both <code class="css-ttvl72">File</code> and <code class="css-ttvl72">io::stdin()</code> implement this trait).</p></div></div><div class="css-doiu0q"><div style="top:0%;bottom:100%" class="css-1nroygx"></div><div><p class="css-1mv7wyt">The LMC has a maximum number of 100 mailboxes, or memory slots available to hold our instructions. We will use an array of 100 elements initialized to 0 (the default state of our mailboxes). Then, using the <code class="css-ttvl72">reader</code> we will proceed to get all the values. The iterator <code class="css-ttvl72">enumerate()</code> is useful because it returns a pair containing the current index of the iteration and the current value.</p></div></div><div class="css-doiu0q"><div style="top:0%;bottom:100%" class="css-1nroygx"></div><div><p class="css-1mv7wyt">Then, fill the <code class="css-ttvl72">mailbox</code> array with the values from <code class="css-ttvl72">reader</code>. Notice the <code class="css-ttvl72">.expect</code> here is used to make our program exit if we can&#x27;t read the file. Since the LMC can only have 100 mailboxes, we break out of the loop once we reach index 99 (because arrays in Rust are zero-based).</p></div></div><div class="css-doiu0q"><div style="top:0%;bottom:100%" class="css-1nroygx"></div><div><p class="css-1mv7wyt">We can see our current progress by printing the values stored in <code class="css-ttvl72">mailbox</code> and then compile and execute our program with <code class="css-ttvl72">cargo run</code>.  Enter some numbers and then press <code class="css-ttvl72">CTRL + D</code> in Linux or <code class="css-ttvl72">CTRL + Z</code> on Windows to display the values in the <code class="css-ttvl72">mailbox</code> array and exit the program. You can also test it with a file by executing <br/><code class="css-ttvl72">cargo run -- --file filename.txt</code>.</p></div></div></div></div><p class="css-1mv7wyt">And that&#x27;s it! We have our main program ready to fill the <code class="css-ttvl72">mailbox</code> array with instructions for the LMC that we are going to build in the next section. </p><h2 class="css-1i9kc2g"><a href="#undefined" class="css-bt6h6g"><svg viewBox="0 0 16 16" width="16" height="16" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Creating the LMC as a library</h2><div class="css-7lbzlp"><div class="css-1iwrzxx"><div style="height:100%;width:100%"><div class="css-vba7jp"><div style="overflow:auto;height:100%;width:100%"><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-eaflqv" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-eyaae1" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-0"><span class="token-comment">// lib.rs</span></div></div><div style="overflow:hidden;opacity:1"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-4"><span class="token-keyword">pub</span><span class="token-plain"> </span><span class="token-keyword">fn</span><span class="token-plain"> </span><span class="token-function">compute</span><span class="token-punctuation">(</span><span class="token-keyword">mut</span><span class="token-plain"> mailbox</span><span class="token-punctuation">:</span><span class="token-plain"> </span><span class="token-punctuation">[</span><span class="token-plain">i32</span><span class="token-punctuation">;</span><span class="token-plain"> </span><span class="token-number">100</span><span class="token-punctuation">]</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-punctuation">{</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-5"><span class="token-plain">  </span><span class="token-keyword">let</span><span class="token-plain"> </span><span class="token-keyword">mut</span><span class="token-plain"> program_cnt</span><span class="token-punctuation">:</span><span class="token-plain"> usize </span><span class="token-operator">=</span><span class="token-plain"> </span><span class="token-number">0</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-6"><span class="token-plain">  </span><span class="token-keyword">let</span><span class="token-plain"> </span><span class="token-keyword">mut</span><span class="token-plain"> accumulator</span><span class="token-punctuation">:</span><span class="token-plain"> i32 </span><span class="token-operator">=</span><span class="token-plain"> </span><span class="token-number">0</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;transform:translateX(250px);height:0;opacity:0"><div style="display:inline-block" class="cs-line cs-line-11"><span class="token-plain">  </span><span class="token-keyword">let</span><span class="token-plain"> index </span><span class="token-punctuation">:</span><span class="token-plain"> usize </span><span class="token-operator">=</span><span class="token-plain"> usize</span><span class="token-punctuation">::</span><span class="token-function">try_from</span><span class="token-punctuation">(</span><span class="token-plain">instruction </span><span class="token-operator">%</span><span class="token-plain"> </span><span class="token-number">100</span><span class="token-punctuation">)</span><span class="token-punctuation">.</span><span class="token-function">unwrap</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-21"><span class="token-punctuation">}</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-eaflqv" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-eyaae1" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;opacity:0.3"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;height:100px;opacity:0.3;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-11"><span class="token-plain">  </span><span class="token-keyword">let</span><span class="token-plain"> index </span><span class="token-punctuation">:</span><span class="token-plain"> usize </span><span class="token-operator">=</span><span class="token-plain"> usize</span><span class="token-punctuation">::</span><span class="token-function">try_from</span><span class="token-punctuation">(</span><span class="token-plain">instruction </span><span class="token-operator">%</span><span class="token-plain"> </span><span class="token-number">100</span><span class="token-punctuation">)</span><span class="token-punctuation">.</span><span class="token-function">unwrap</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;transform:translateX(250px);height:0;opacity:0"><div style="display:inline-block" class="cs-line cs-line-19"><span class="token-plain">    _ </span><span class="token-operator">=&gt;</span><span class="token-plain"> </span><span class="token-function">panic!</span><span class="token-punctuation">(</span><span class="token-function">format!</span><span class="token-punctuation">(</span><span class="token-string">&quot;Invalid action: {}&quot;</span><span class="token-punctuation">,</span><span class="token-plain"> mailbox</span><span class="token-punctuation">[</span><span class="token-plain">program_cnt</span><span class="token-punctuation">]</span><span class="token-punctuation">)</span><span class="token-punctuation">)</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-eaflqv" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-eyaae1" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;height:100px;opacity:0.3;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;height:100px;opacity:0.3;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-19"><span class="token-plain">    _ </span><span class="token-operator">=&gt;</span><span class="token-plain"> </span><span class="token-function">panic!</span><span class="token-punctuation">(</span><span class="token-function">format!</span><span class="token-punctuation">(</span><span class="token-string">&quot;Invalid action: {}&quot;</span><span class="token-punctuation">,</span><span class="token-plain"> mailbox</span><span class="token-punctuation">[</span><span class="token-plain">program_cnt</span><span class="token-punctuation">]</span><span class="token-punctuation">)</span><span class="token-punctuation">)</span></div></div><div></div></code></pre></div></div></div></div></div></div><div class="scroller css-1uvj81"><div class="css-doiu0q"><div style="top:0%;bottom:0%;width:3px" class="css-1nroygx"></div><div><p class="css-1mv7wyt">Ideally, our LMC program could be used as a binary executable or as a library, in case we want to publish it as a crate. Create a file <code class="css-ttvl72">src/lib.rs</code>. This file will contain all the logic for the LMC described above. In this file we will add a function <code class="css-ttvl72">compute</code> that receives the <code class="css-ttvl72">mailbox</code> array. Also, we will declare two variables: <code class="css-ttvl72">program_cnt</code> representing our counter, and <code class="css-ttvl72">accumulator</code>, for the calculator value. Since <code class="css-ttvl72">program_cnt</code> represents an index in the <code class="css-ttvl72">mailbox</code> array, we use the type <code class="css-ttvl72">usize</code>.</p></div></div><div class="css-doiu0q"><div style="top:0%;bottom:100%" class="css-1nroygx"></div><div><p class="css-1mv7wyt">An instruction in the LMC is represented by a three digits number. The first digit being the <code class="css-ttvl72">code</code>, and the other digits are the index of the mailbox to apply the instruction. Notice that we cast the index from <code class="css-ttvl72">i32</code> to <code class="css-ttvl72">usize</code> with <code class="css-ttvl72">try_from</code>.</p></div></div><div class="css-doiu0q"><div style="top:0%;bottom:100%" class="css-1nroygx"></div><div><p class="css-1mv7wyt">Here we implement first the simpler actions from the instruction table. The <code class="css-ttvl72">_</code> will be used to exit the LMC program with an error when it receives an Invalid action.</p></div></div></div></div><h2 class="css-1i9kc2g"><a href="#undefined" class="css-bt6h6g"><svg viewBox="0 0 16 16" width="16" height="16" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Using our library</h2><div class="css-7lbzlp"><div class="css-1iwrzxx"><div style="height:100%;width:100%"><div class="css-vba7jp"><div style="overflow:auto;height:100%;width:100%"><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-eaflqv" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-eyaae1" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-0"><span class="token-comment">// main.rs</span></div></div><div style="overflow:hidden;opacity:1"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-2"><span class="token-keyword">use</span><span class="token-plain"> clap</span><span class="token-punctuation">::</span><span class="token-punctuation">{</span><span class="token-plain">Arg</span><span class="token-punctuation">,</span><span class="token-plain"> App</span><span class="token-punctuation">}</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-3"><span class="token-keyword">use</span><span class="token-plain"> std</span><span class="token-punctuation">::</span><span class="token-plain">io</span><span class="token-punctuation">::</span><span class="token-punctuation">{</span><span class="token-keyword">self</span><span class="token-punctuation">,</span><span class="token-plain"> BufRead</span><span class="token-punctuation">,</span><span class="token-plain"> BufReader</span><span class="token-punctuation">}</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-4"><span class="token-keyword">use</span><span class="token-plain"> std</span><span class="token-punctuation">::</span><span class="token-plain">fs</span><span class="token-punctuation">::</span><span class="token-plain">File</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-6"><span class="token-plain">​</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-7"><span class="token-keyword">fn</span><span class="token-plain"> </span><span class="token-function">main</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-punctuation">{</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-8"><span class="token-plain">  </span><span class="token-keyword">let</span><span class="token-plain"> matches </span><span class="token-operator">=</span><span class="token-plain"> App</span><span class="token-punctuation">::</span><span class="token-function">new</span><span class="token-punctuation">(</span><span class="token-string">&quot;Little man computer&quot;</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-9"><span class="token-plain">    </span><span class="token-punctuation">.</span><span class="token-function">version</span><span class="token-punctuation">(</span><span class="token-string">&quot;1.0&quot;</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-10"><span class="token-plain">    </span><span class="token-punctuation">.</span><span class="token-function">arg</span><span class="token-punctuation">(</span><span class="token-plain">Arg</span><span class="token-punctuation">::</span><span class="token-function">with_name</span><span class="token-punctuation">(</span><span class="token-string">&quot;file&quot;</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-11"><span class="token-plain">      </span><span class="token-punctuation">.</span><span class="token-function">short</span><span class="token-punctuation">(</span><span class="token-string">&quot;f&quot;</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-12"><span class="token-plain">      </span><span class="token-punctuation">.</span><span class="token-function">long</span><span class="token-punctuation">(</span><span class="token-string">&quot;file&quot;</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-13"><span class="token-plain">      </span><span class="token-punctuation">.</span><span class="token-function">help</span><span class="token-punctuation">(</span><span class="token-string">&quot;Indicates that the input is a file path&quot;</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-14"><span class="token-plain">      </span><span class="token-punctuation">.</span><span class="token-function">takes_value</span><span class="token-punctuation">(</span><span class="token-keyword">true</span><span class="token-punctuation">)</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-15"><span class="token-plain">      </span><span class="token-punctuation">.</span><span class="token-function">get_matches</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-16"><span class="token-plain">​</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-17"><span class="token-plain">  </span><span class="token-comment">// If --file is present, read the values from a file</span></div></div><div style="overflow:hidden;opacity:1"><div style="display:inline-block" class="cs-line cs-line-18"><span class="token-plain">  </span><span class="token-keyword">let</span><span class="token-plain"> reader</span><span class="token-punctuation">:</span><span class="token-plain"> Box</span><span class="token-operator">&lt;</span><span class="token-keyword">dyn</span><span class="token-plain"> BufRead</span><span class="token-operator">&gt;</span><span class="token-plain"> </span><span class="token-operator">=</span><span class="token-plain"> </span><span class="token-keyword">match</span><span class="token-plain"> matches</span><span class="token-punctuation">.</span><span class="token-function">value_of</span><span class="token-punctuation">(</span><span class="token-string">&quot;file&quot;</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-punctuation">{</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-19"><span class="token-plain">    </span><span class="token-function">Some</span><span class="token-punctuation">(</span><span class="token-plain">file_path</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-operator">=&gt;</span><span class="token-plain"> </span><span class="token-punctuation">{</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-20"><span class="token-plain">      </span><span class="token-keyword">let</span><span class="token-plain"> path </span><span class="token-operator">=</span><span class="token-plain"> std</span><span class="token-punctuation">::</span><span class="token-plain">path</span><span class="token-punctuation">::</span><span class="token-plain">PathBuf</span><span class="token-punctuation">::</span><span class="token-function">from</span><span class="token-punctuation">(</span><span class="token-plain">file_path</span><span class="token-punctuation">)</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-21"><span class="token-plain">      </span><span class="token-keyword">let</span><span class="token-plain"> f </span><span class="token-operator">=</span><span class="token-plain"> File</span><span class="token-punctuation">::</span><span class="token-function">open</span><span class="token-punctuation">(</span><span class="token-plain">path</span><span class="token-punctuation">)</span><span class="token-punctuation">.</span><span class="token-function">expect</span><span class="token-punctuation">(</span><span class="token-string">&quot;File not found&quot;</span><span class="token-punctuation">)</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-22"><span class="token-plain">      Box</span><span class="token-punctuation">::</span><span class="token-function">new</span><span class="token-punctuation">(</span><span class="token-plain">BufReader</span><span class="token-punctuation">::</span><span class="token-function">new</span><span class="token-punctuation">(</span><span class="token-plain">f</span><span class="token-punctuation">)</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-23"><span class="token-plain">    </span><span class="token-punctuation">}</span><span class="token-punctuation">,</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-24"><span class="token-plain">    None </span><span class="token-operator">=&gt;</span><span class="token-plain"> Box</span><span class="token-punctuation">::</span><span class="token-function">new</span><span class="token-punctuation">(</span><span class="token-plain">BufReader</span><span class="token-punctuation">::</span><span class="token-function">new</span><span class="token-punctuation">(</span><span class="token-plain">io</span><span class="token-punctuation">::</span><span class="token-function">stdin</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-punctuation">)</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-25"><span class="token-plain">  </span><span class="token-punctuation">}</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-26"><span class="token-plain">​</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-27"><span class="token-plain">  </span><span class="token-comment">// Fill mailbox</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-28"><span class="token-plain">  </span><span class="token-keyword">let</span><span class="token-plain"> </span><span class="token-keyword">mut</span><span class="token-plain"> mailbox</span><span class="token-punctuation">:</span><span class="token-plain"> </span><span class="token-punctuation">[</span><span class="token-plain">i32</span><span class="token-punctuation">;</span><span class="token-plain"> </span><span class="token-number">100</span><span class="token-punctuation">]</span><span class="token-plain"> </span><span class="token-operator">=</span><span class="token-plain"> </span><span class="token-punctuation">[</span><span class="token-number">0</span><span class="token-punctuation">;</span><span class="token-plain"> </span><span class="token-number">100</span><span class="token-punctuation">]</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-29"><span class="token-plain">  </span><span class="token-keyword">for</span><span class="token-plain"> </span><span class="token-punctuation">(</span><span class="token-plain">i</span><span class="token-punctuation">,</span><span class="token-plain"> value</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-keyword">in</span><span class="token-plain"> reader</span><span class="token-punctuation">.</span><span class="token-function">lines</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-punctuation">.</span><span class="token-function">enumerate</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-punctuation">{</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-30"><span class="token-plain">    mailbox</span><span class="token-punctuation">[</span><span class="token-plain">i</span><span class="token-punctuation">]</span><span class="token-plain"> </span><span class="token-operator">=</span><span class="token-plain"> value</span><span class="token-punctuation">.</span><span class="token-function">unwrap</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-31"><span class="token-plain">                      </span><span class="token-punctuation">.</span><span class="token-function">trim</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-32"><span class="token-plain">                      </span><span class="token-punctuation">.</span><span class="token-function">parse</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-33"><span class="token-plain">                      </span><span class="token-punctuation">.</span><span class="token-function">expect</span><span class="token-punctuation">(</span><span class="token-operator">&amp;</span><span class="token-function">format!</span><span class="token-punctuation">(</span><span class="token-string">&quot;NaN on line {}&quot;</span><span class="token-punctuation">,</span><span class="token-plain"> i </span><span class="token-operator">+</span><span class="token-plain"> </span><span class="token-number">1</span><span class="token-punctuation">)</span><span class="token-punctuation">)</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-34"><span class="token-plain">​</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-35"><span class="token-plain">    </span><span class="token-keyword">if</span><span class="token-plain"> i </span><span class="token-operator">==</span><span class="token-plain"> </span><span class="token-number">99</span><span class="token-plain"> </span><span class="token-punctuation">{</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-36"><span class="token-plain">      </span><span class="token-keyword">break</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-37"><span class="token-plain">    </span><span class="token-punctuation">}</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-38"><span class="token-plain">  </span><span class="token-punctuation">}</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-39"><span class="token-plain">​</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-42"><span class="token-plain">  </span><span class="token-function">println!</span><span class="token-punctuation">(</span><span class="token-string">&quot;Instructions: {:?}&quot;</span><span class="token-punctuation">,</span><span class="token-plain"> </span><span class="token-operator">&amp;</span><span class="token-plain">mailbox</span><span class="token-punctuation">[</span><span class="token-punctuation">..</span><span class="token-punctuation">]</span><span class="token-punctuation">)</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-43"><span class="token-punctuation">}</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-eaflqv" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-eyaae1" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;opacity:0.3"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;opacity:0.3"><div style="display:inline-block" class="cs-line cs-line-18"><span class="token-plain">  </span><span class="token-keyword">let</span><span class="token-plain"> reader</span><span class="token-punctuation">:</span><span class="token-plain"> Box</span><span class="token-operator">&lt;</span><span class="token-keyword">dyn</span><span class="token-plain"> BufRead</span><span class="token-operator">&gt;</span><span class="token-plain"> </span><span class="token-operator">=</span><span class="token-plain"> </span><span class="token-keyword">match</span><span class="token-plain"> matches</span><span class="token-punctuation">.</span><span class="token-function">value_of</span><span class="token-punctuation">(</span><span class="token-string">&quot;file&quot;</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-punctuation">{</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-eaflqv" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-eyaae1" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;height:100px;opacity:0.3;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;height:100px;opacity:0.3;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-18"><span class="token-plain">  </span><span class="token-keyword">let</span><span class="token-plain"> reader</span><span class="token-punctuation">:</span><span class="token-plain"> Box</span><span class="token-operator">&lt;</span><span class="token-keyword">dyn</span><span class="token-plain"> BufRead</span><span class="token-operator">&gt;</span><span class="token-plain"> </span><span class="token-operator">=</span><span class="token-plain"> </span><span class="token-keyword">match</span><span class="token-plain"> matches</span><span class="token-punctuation">.</span><span class="token-function">value_of</span><span class="token-punctuation">(</span><span class="token-string">&quot;file&quot;</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-punctuation">{</span></div></div><div></div></code></pre></div></div></div></div></div></div><div class="scroller css-1uvj81"><div class="css-doiu0q"><div style="top:0%;bottom:0%;width:3px" class="css-1nroygx"></div><div><p class="css-1mv7wyt">So, let&#x27;s see our progress so far. We have a program that reads a series of instructions either from the command line or from a file. There&#x27;s also a library file, however, it&#x27;s not being invoked by our main program.</p></div></div><div class="css-doiu0q"><div style="top:0%;bottom:100%" class="css-1nroygx"></div><div><p class="css-1mv7wyt">Import the library.</p></div></div><div class="css-doiu0q"><div style="top:0%;bottom:100%" class="css-1nroygx"></div><div><p class="css-1mv7wyt">And then call the function compute by passing the <code class="css-ttvl72">mailbox</code> array as a parameter.</p></div></div></div></div><p class="css-1mv7wyt">Execute <code class="css-ttvl72">cargo run</code> and enter the following instructions:</p><div class="css-1cd8nnu"><pre class=" prism-code language- css-1kcvdi7"><div class="token-line"><span class="token plain css-1baulvz">901</span></div><div class="token-line"><span class="token plain css-1baulvz">902</span></div><div class="token-line"><span class="token plain css-1baulvz">000</span></div><div class="token-line"><span class="token plain css-1baulvz">(remember to use `CTRL + D` in Linux / `CTRL + Z` in Windows)</span></div></pre></div><div class="css-7lbzlp"><div class="css-1iwrzxx"><div style="height:100%;width:100%"><div class="css-vba7jp"><div style="overflow:auto;height:100%;width:100%"><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-eaflqv" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-eyaae1" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-0"><span class="token-comment">// lib.rs</span></div></div><div style="overflow:hidden;opacity:1"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-2"><span class="token-keyword">use</span><span class="token-plain"> std</span><span class="token-punctuation">::</span><span class="token-plain">convert</span><span class="token-punctuation">::</span><span class="token-plain">TryFrom</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-3"><span class="token-keyword">use</span><span class="token-plain"> text_io</span><span class="token-punctuation">::</span><span class="token-plain">read</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-4"><span class="token-keyword">use</span><span class="token-plain"> std</span><span class="token-punctuation">::</span><span class="token-plain">io</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-5"><span class="token-keyword">use</span><span class="token-plain"> std</span><span class="token-punctuation">::</span><span class="token-plain">io</span><span class="token-punctuation">::</span><span class="token-plain">Write</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-6"><span class="token-plain">​</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-7"><span class="token-keyword">pub</span><span class="token-plain"> </span><span class="token-keyword">fn</span><span class="token-plain"> </span><span class="token-function">compute</span><span class="token-punctuation">(</span><span class="token-keyword">mut</span><span class="token-plain"> mailbox</span><span class="token-punctuation">:</span><span class="token-plain"> </span><span class="token-punctuation">[</span><span class="token-plain">i32</span><span class="token-punctuation">;</span><span class="token-plain"> </span><span class="token-number">100</span><span class="token-punctuation">]</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-punctuation">{</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-8"><span class="token-plain">  </span><span class="token-keyword">let</span><span class="token-plain"> </span><span class="token-keyword">mut</span><span class="token-plain"> program_cnt</span><span class="token-punctuation">:</span><span class="token-plain"> usize </span><span class="token-operator">=</span><span class="token-plain"> </span><span class="token-number">0</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-9"><span class="token-plain">  </span><span class="token-keyword">let</span><span class="token-plain"> </span><span class="token-keyword">mut</span><span class="token-plain"> accumulator</span><span class="token-punctuation">:</span><span class="token-plain"> i32 </span><span class="token-operator">=</span><span class="token-plain"> </span><span class="token-number">0</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-10"><span class="token-plain">    </span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-15"><span class="token-plain">  </span><span class="token-keyword">let</span><span class="token-plain"> instruction </span><span class="token-operator">=</span><span class="token-plain"> mailbox</span><span class="token-punctuation">[</span><span class="token-plain">program_cnt</span><span class="token-punctuation">]</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-16"><span class="token-plain">  </span><span class="token-keyword">let</span><span class="token-plain"> code </span><span class="token-punctuation">:</span><span class="token-plain"> i32 </span><span class="token-operator">=</span><span class="token-plain"> instruction </span><span class="token-operator">/</span><span class="token-plain"> </span><span class="token-number">100</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-17"><span class="token-plain">  </span><span class="token-keyword">let</span><span class="token-plain"> index </span><span class="token-punctuation">:</span><span class="token-plain"> usize </span><span class="token-operator">=</span><span class="token-plain"> usize</span><span class="token-punctuation">::</span><span class="token-function">try_from</span><span class="token-punctuation">(</span><span class="token-plain">instruction </span><span class="token-operator">%</span><span class="token-plain"> </span><span class="token-number">100</span><span class="token-punctuation">)</span><span class="token-punctuation">.</span><span class="token-function">unwrap</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-18"><span class="token-plain">    </span></div></div><div style="overflow:hidden;transform:translateX(250px);height:0;opacity:0"><div style="display:inline-block" class="cs-line cs-line-25"><span class="token-plain">      _ </span><span class="token-operator">=&gt;</span><span class="token-plain"> </span><span class="token-function">panic!</span><span class="token-punctuation">(</span><span class="token-function">format!</span><span class="token-punctuation">(</span><span class="token-string">&quot;Invalid action: {}&quot;</span><span class="token-punctuation">,</span><span class="token-plain"> mailbox</span><span class="token-punctuation">[</span><span class="token-plain">program_cnt</span><span class="token-punctuation">]</span><span class="token-punctuation">)</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-29"><span class="token-plain">  </span><span class="token-keyword">match</span><span class="token-plain"> code </span><span class="token-punctuation">{</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-30"><span class="token-plain">    </span><span class="token-number">1</span><span class="token-plain"> </span><span class="token-operator">=&gt;</span><span class="token-plain"> accumulator </span><span class="token-operator">+=</span><span class="token-plain"> mailbox</span><span class="token-punctuation">[</span><span class="token-plain">index</span><span class="token-punctuation">]</span><span class="token-punctuation">,</span><span class="token-plain"> </span><span class="token-comment">// ADD</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-31"><span class="token-plain">    </span><span class="token-number">2</span><span class="token-plain"> </span><span class="token-operator">=&gt;</span><span class="token-plain"> accumulator </span><span class="token-operator">-=</span><span class="token-plain"> mailbox</span><span class="token-punctuation">[</span><span class="token-plain">index</span><span class="token-punctuation">]</span><span class="token-punctuation">,</span><span class="token-plain"> </span><span class="token-comment">// SUBSTRACT</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-32"><span class="token-plain">    </span><span class="token-number">3</span><span class="token-plain"> </span><span class="token-operator">=&gt;</span><span class="token-plain"> mailbox</span><span class="token-punctuation">[</span><span class="token-plain">index</span><span class="token-punctuation">]</span><span class="token-plain"> </span><span class="token-operator">=</span><span class="token-plain"> accumulator</span><span class="token-punctuation">,</span><span class="token-plain"> </span><span class="token-comment">// STORE</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-33"><span class="token-plain">    </span><span class="token-number">5</span><span class="token-plain"> </span><span class="token-operator">=&gt;</span><span class="token-plain"> accumulator </span><span class="token-operator">=</span><span class="token-plain"> mailbox</span><span class="token-punctuation">[</span><span class="token-plain">index</span><span class="token-punctuation">]</span><span class="token-punctuation">,</span><span class="token-plain"> </span><span class="token-comment">// LOAD</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-34"><span class="token-plain">    </span><span class="token-number">0</span><span class="token-plain"> </span><span class="token-operator">=&gt;</span><span class="token-plain"> </span><span class="token-keyword">return</span><span class="token-punctuation">,</span><span class="token-plain"> </span><span class="token-comment">// HALT</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-35"><span class="token-plain">    _ </span><span class="token-operator">=&gt;</span><span class="token-plain"> </span><span class="token-function">panic!</span><span class="token-punctuation">(</span><span class="token-function">format!</span><span class="token-punctuation">(</span><span class="token-string">&quot;Invalid action: {}&quot;</span><span class="token-punctuation">,</span><span class="token-plain"> mailbox</span><span class="token-punctuation">[</span><span class="token-plain">program_cnt</span><span class="token-punctuation">]</span><span class="token-punctuation">)</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-36"><span class="token-plain">  </span><span class="token-punctuation">}</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-37"><span class="token-punctuation">}</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-eaflqv" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-eyaae1" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;height:100px;opacity:0.3;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;height:100px;opacity:0.3;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-25"><span class="token-plain">      _ </span><span class="token-operator">=&gt;</span><span class="token-plain"> </span><span class="token-function">panic!</span><span class="token-punctuation">(</span><span class="token-function">format!</span><span class="token-punctuation">(</span><span class="token-string">&quot;Invalid action: {}&quot;</span><span class="token-punctuation">,</span><span class="token-plain"> mailbox</span><span class="token-punctuation">[</span><span class="token-plain">program_cnt</span><span class="token-punctuation">]</span><span class="token-punctuation">)</span><span class="token-punctuation">)</span></div></div><div></div></code></pre></div></div></div></div></div></div><div class="scroller css-1uvj81"><div class="css-doiu0q"><div style="top:0%;bottom:0%;width:3px" class="css-1nroygx"></div><div><p class="css-1mv7wyt">You&#x27;ll notice that after entering the instructions, only the first instruction is executed. </p></div></div><div class="css-doiu0q"><div style="top:0%;bottom:100%" class="css-1nroygx"></div><div><p class="css-1mv7wyt">We are missing a loop in our library. Add a <code class="css-ttvl72">loop</code> and increase the counter on each iteration: </p></div></div></div></div><p class="css-1mv7wyt">Now if we run the program with <code class="css-ttvl72">cargo run</code>, we&#x27;ll see it executes each instruction.</p><div class="css-1cd8nnu"><pre class=" prism-code language- css-1kcvdi7"><div class="token-line"><span class="token plain css-1baulvz">cargo run</span></div><div class="token-line"><span class="token plain css-1baulvz">    Finished dev [unoptimized + debuginfo] target(s) in 0.01s</span></div><div class="token-line"><span class="token plain css-1baulvz">     Running `target/debug/lmc`</span></div><div class="token-line"><span class="token plain css-1baulvz">901</span></div><div class="token-line"><span class="token plain css-1baulvz">902</span></div><div class="token-line"><span class="token plain css-1baulvz">000</span></div><div class="token-line"><span class="token plain css-1baulvz">Input:</span></div></pre></div><h2 class="css-1i9kc2g"><a href="#undefined" class="css-bt6h6g"><svg viewBox="0 0 16 16" width="16" height="16" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Input, output and branching instructions</h2><p class="css-1mv7wyt">To implement the READ instruction, we&#x27;ll use the <code class="css-ttvl72">text_io</code> crate. Add it to the <code class="css-ttvl72">Cargo.toml</code> file</p><div class="css-1cd8nnu"><pre class="language-toml prism-code language-toml css-1kcvdi7"><div class="token-line"><span class="token plain css-1baulvz">[dependencies]</span></div><div class="token-line"><span class="token plain css-1baulvz">clap = &quot;2.33.0&quot;</span></div><div class="token-line"><span class="token plain css-1baulvz">text_io = &quot;0.1.8&quot;</span></div></pre></div><div class="css-7lbzlp"><div class="css-1iwrzxx"><div style="height:100%;width:100%"><div class="css-vba7jp"><div style="overflow:auto;height:100%;width:100%"><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-eaflqv" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-eyaae1" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-0"><span class="token-comment">// lib.rs</span></div></div><div style="overflow:hidden;opacity:1"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-2"><span class="token-keyword">use</span><span class="token-plain"> std</span><span class="token-punctuation">::</span><span class="token-plain">convert</span><span class="token-punctuation">::</span><span class="token-plain">TryFrom</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-3"><span class="token-keyword">use</span><span class="token-plain"> text_io</span><span class="token-punctuation">::</span><span class="token-plain">read</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-4"><span class="token-keyword">use</span><span class="token-plain"> std</span><span class="token-punctuation">::</span><span class="token-plain">io</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-5"><span class="token-keyword">use</span><span class="token-plain"> std</span><span class="token-punctuation">::</span><span class="token-plain">io</span><span class="token-punctuation">::</span><span class="token-plain">Write</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-6"><span class="token-plain">​</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-7"><span class="token-keyword">pub</span><span class="token-plain"> </span><span class="token-keyword">fn</span><span class="token-plain"> </span><span class="token-function">compute</span><span class="token-punctuation">(</span><span class="token-keyword">mut</span><span class="token-plain"> mailbox</span><span class="token-punctuation">:</span><span class="token-plain"> </span><span class="token-punctuation">[</span><span class="token-plain">i32</span><span class="token-punctuation">;</span><span class="token-plain"> </span><span class="token-number">100</span><span class="token-punctuation">]</span><span class="token-punctuation">)</span><span class="token-plain"> </span><span class="token-punctuation">{</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-8"><span class="token-plain">  </span><span class="token-keyword">let</span><span class="token-plain"> </span><span class="token-keyword">mut</span><span class="token-plain"> program_cnt</span><span class="token-punctuation">:</span><span class="token-plain"> usize </span><span class="token-operator">=</span><span class="token-plain"> </span><span class="token-number">0</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-9"><span class="token-plain">  </span><span class="token-keyword">let</span><span class="token-plain"> </span><span class="token-keyword">mut</span><span class="token-plain"> accumulator</span><span class="token-punctuation">:</span><span class="token-plain"> i32 </span><span class="token-operator">=</span><span class="token-plain"> </span><span class="token-number">0</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-10"><span class="token-plain">    </span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-11"><span class="token-plain">  </span><span class="token-keyword">loop</span><span class="token-plain"> </span><span class="token-punctuation">{</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-12"><span class="token-plain">    </span><span class="token-keyword">let</span><span class="token-plain"> instruction </span><span class="token-operator">=</span><span class="token-plain"> mailbox</span><span class="token-punctuation">[</span><span class="token-plain">program_cnt</span><span class="token-punctuation">]</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-13"><span class="token-plain">    </span><span class="token-keyword">let</span><span class="token-plain"> code </span><span class="token-punctuation">:</span><span class="token-plain"> i32 </span><span class="token-operator">=</span><span class="token-plain"> instruction </span><span class="token-operator">/</span><span class="token-plain"> </span><span class="token-number">100</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-14"><span class="token-plain">    </span><span class="token-keyword">let</span><span class="token-plain"> index </span><span class="token-punctuation">:</span><span class="token-plain"> usize </span><span class="token-operator">=</span><span class="token-plain"> usize</span><span class="token-punctuation">::</span><span class="token-function">try_from</span><span class="token-punctuation">(</span><span class="token-plain">instruction </span><span class="token-operator">%</span><span class="token-plain"> </span><span class="token-number">100</span><span class="token-punctuation">)</span><span class="token-punctuation">.</span><span class="token-function">unwrap</span><span class="token-punctuation">(</span><span class="token-punctuation">)</span><span class="token-punctuation">;</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-15"><span class="token-plain">​</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-16"><span class="token-plain">    </span><span class="token-keyword">match</span><span class="token-plain"> code </span><span class="token-punctuation">{</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-17"><span class="token-plain">      </span><span class="token-number">1</span><span class="token-plain"> </span><span class="token-operator">=&gt;</span><span class="token-plain"> accumulator </span><span class="token-operator">+=</span><span class="token-plain"> mailbox</span><span class="token-punctuation">[</span><span class="token-plain">index</span><span class="token-punctuation">]</span><span class="token-punctuation">,</span><span class="token-plain"> </span><span class="token-comment">// ADD</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-18"><span class="token-plain">      </span><span class="token-number">2</span><span class="token-plain"> </span><span class="token-operator">=&gt;</span><span class="token-plain"> accumulator </span><span class="token-operator">-=</span><span class="token-plain"> mailbox</span><span class="token-punctuation">[</span><span class="token-plain">index</span><span class="token-punctuation">]</span><span class="token-punctuation">,</span><span class="token-plain"> </span><span class="token-comment">// SUBSTRACT</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-19"><span class="token-plain">      </span><span class="token-number">3</span><span class="token-plain"> </span><span class="token-operator">=&gt;</span><span class="token-plain"> mailbox</span><span class="token-punctuation">[</span><span class="token-plain">index</span><span class="token-punctuation">]</span><span class="token-plain"> </span><span class="token-operator">=</span><span class="token-plain"> accumulator</span><span class="token-punctuation">,</span><span class="token-plain"> </span><span class="token-comment">// STORE</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-20"><span class="token-plain">      </span><span class="token-number">5</span><span class="token-plain"> </span><span class="token-operator">=&gt;</span><span class="token-plain"> accumulator </span><span class="token-operator">=</span><span class="token-plain"> mailbox</span><span class="token-punctuation">[</span><span class="token-plain">index</span><span class="token-punctuation">]</span><span class="token-punctuation">,</span><span class="token-plain"> </span><span class="token-comment">// LOAD</span></div></div><div style="overflow:hidden;transform:translateX(250px);height:0;opacity:0"><div style="display:inline-block" class="cs-line cs-line-45"><span class="token-plain">        _ </span><span class="token-operator">=&gt;</span><span class="token-plain"> </span><span class="token-function">panic!</span><span class="token-punctuation">(</span><span class="token-function">format!</span><span class="token-punctuation">(</span><span class="token-string">&quot;Invalid action: {}&quot;</span><span class="token-punctuation">,</span><span class="token-plain"> mailbox</span><span class="token-punctuation">[</span><span class="token-plain">program_cnt</span><span class="token-punctuation">]</span><span class="token-punctuation">)</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-47"><span class="token-plain">      </span><span class="token-number">0</span><span class="token-plain"> </span><span class="token-operator">=&gt;</span><span class="token-plain"> </span><span class="token-keyword">return</span><span class="token-punctuation">,</span><span class="token-plain"> </span><span class="token-comment">// HALT</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-48"><span class="token-plain">      _ </span><span class="token-operator">=&gt;</span><span class="token-plain"> </span><span class="token-function">panic!</span><span class="token-punctuation">(</span><span class="token-function">format!</span><span class="token-punctuation">(</span><span class="token-string">&quot;Invalid action: {}&quot;</span><span class="token-punctuation">,</span><span class="token-plain"> mailbox</span><span class="token-punctuation">[</span><span class="token-plain">program_cnt</span><span class="token-punctuation">]</span><span class="token-punctuation">)</span><span class="token-punctuation">)</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-49"><span class="token-plain">    </span><span class="token-punctuation">}</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-50"><span class="token-plain">  </span><span class="token-punctuation">}</span></div></div><div style="overflow:hidden;height:100px;opacity:1;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-51"><span class="token-punctuation">}</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-eaflqv" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-eyaae1" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;opacity:0.3"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;opacity:0.3"><div style="display:inline-block" class="cs-line cs-line-45"><span class="token-plain">        _ </span><span class="token-operator">=&gt;</span><span class="token-plain"> </span><span class="token-function">panic!</span><span class="token-punctuation">(</span><span class="token-function">format!</span><span class="token-punctuation">(</span><span class="token-string">&quot;Invalid action: {}&quot;</span><span class="token-punctuation">,</span><span class="token-plain"> mailbox</span><span class="token-punctuation">[</span><span class="token-plain">program_cnt</span><span class="token-punctuation">]</span><span class="token-punctuation">)</span><span class="token-punctuation">)</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-eaflqv" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-eyaae1" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;opacity:0.3"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;opacity:0.3"><div style="display:inline-block" class="cs-line cs-line-45"><span class="token-plain">        _ </span><span class="token-operator">=&gt;</span><span class="token-plain"> </span><span class="token-function">panic!</span><span class="token-punctuation">(</span><span class="token-function">format!</span><span class="token-punctuation">(</span><span class="token-string">&quot;Invalid action: {}&quot;</span><span class="token-punctuation">,</span><span class="token-plain"> mailbox</span><span class="token-punctuation">[</span><span class="token-plain">program_cnt</span><span class="token-punctuation">]</span><span class="token-punctuation">)</span><span class="token-punctuation">)</span></div></div><div></div></code></pre></div></div><div style="overflow:auto;height:100%;width:100%"><div class="cs-container" style="width:100%;height:100%;max-height:100%;position:relative"><pre class="cs-content css-eaflqv" style="margin:0;height:100%;overflow:hidden"><code class="cs-scaled-content css-eyaae1" style="display:block;height:100%;transform:scale(1);transform-origin:center 0px"><div></div><div style="overflow:hidden;height:100px;opacity:0.3;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-1"><span class="token-plain">​</span></div></div><div style="overflow:hidden;height:100px;opacity:0.3;transform:translateX(0px)"><div style="display:inline-block" class="cs-line cs-line-45"><span class="token-plain">        _ </span><span class="token-operator">=&gt;</span><span class="token-plain"> </span><span class="token-function">panic!</span><span class="token-punctuation">(</span><span class="token-function">format!</span><span class="token-punctuation">(</span><span class="token-string">&quot;Invalid action: {}&quot;</span><span class="token-punctuation">,</span><span class="token-plain"> mailbox</span><span class="token-punctuation">[</span><span class="token-plain">program_cnt</span><span class="token-punctuation">]</span><span class="token-punctuation">)</span><span class="token-punctuation">)</span></div></div><div></div></code></pre></div></div></div></div></div></div><div class="scroller css-1uvj81"><div class="css-doiu0q"><div style="top:0%;bottom:0%;width:3px" class="css-1nroygx"></div><div><p class="css-1mv7wyt">Let&#x27;s go back and edit <code class="css-ttvl72">lib.rs</code>. We are only missing a few instructions to complete our LMC.</p></div></div><div class="css-doiu0q"><div style="top:0%;bottom:100%" class="css-1nroygx"></div><div><p class="css-1mv7wyt">We can implement instruction <code class="css-ttvl72">901</code>, using the <code class="css-ttvl72">read!</code> macro. Notice that we used <code class="css-ttvl72">io::stdout().flush().unwrap()</code> after the <code class="css-ttvl72">print!</code>. This is because we want to display the string <code class="css-ttvl72">&quot;Input: &quot;</code> before we read a value. </p></div></div><div class="css-doiu0q"><div style="top:0%;bottom:100%" class="css-1nroygx"></div><div><p class="css-1mv7wyt">To implement the PRINT instruction (<code class="css-ttvl72">902</code>) we only need to display the value we have in the accumulator with a <code class="css-ttvl72">println!</code>.</p></div></div><div class="css-doiu0q"><div style="top:0%;bottom:100%" class="css-1nroygx"></div><div><p class="css-1mv7wyt">The instructions <code class="css-ttvl72">6xx</code>, <code class="css-ttvl72">7xx</code> and <code class="css-ttvl72">8xx</code> are very similar except for their conditions to change the counter value. We need to use a <code class="css-ttvl72">continue</code> to avoid increasing the program counter after executing the instruction.</p></div></div></div></div><p class="css-1mv7wyt">And with this, the LMC is complete! You can create a more complex program to see the LMC in action:</p><p class="css-1mv7wyt"><code class="css-ttvl72">countdown.txt</code></p><div class="css-1cd8nnu"><pre class=" prism-code language- css-1kcvdi7"><div class="token-line"><span class="token plain css-1baulvz">901</span></div><div class="token-line"><span class="token plain css-1baulvz">902</span></div><div class="token-line"><span class="token plain css-1baulvz">308</span></div><div class="token-line"><span class="token plain css-1baulvz">207</span></div><div class="token-line"><span class="token plain css-1baulvz">308</span></div><div class="token-line"><span class="token plain css-1baulvz">801</span></div><div class="token-line"><span class="token plain css-1baulvz">000</span></div><div class="token-line"><span class="token plain css-1baulvz">001</span></div><div class="token-line"><span class="token plain css-1baulvz">000</span></div></pre></div><div class="css-1cd8nnu"><pre class="language-bash prism-code language-bash css-1kcvdi7"><div class="token-line"><span class="token plain css-1baulvz">cargo run -- --file ./countdown.txt</span></div></pre></div><h2 class="css-1i9kc2g"><a href="#undefined" class="css-bt6h6g"><svg viewBox="0 0 16 16" width="16" height="16" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Final thoughts</h2><p class="css-1mv7wyt">The LMC program is like assembly language that a CPU understands, and it serves as a good introduction to learn how a computer works. Try creating some programs and find ways to improve the LMC! (some ideas: extend the program with non-standard instructions to print ascii characters, create a lexer to accept the mnemonics instead of the numeric codes, validate the instructions and input data).</p></main><style data-emotion-css="47xi18">.css-47xi18{margin-top:56px;padding-top:28px;}</style><footer class="css-47xi18"><hr class="css-5rlcw3"/><style data-emotion-css="11r1i3o">.css-11r1i3o{-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;list-style:none;padding:0;}</style><style data-emotion-css="1qfxf3w">.css-1qfxf3w{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;list-style:none;padding:0;}</style><ul class="css-1qfxf3w"><li><a rel="prev" class="css-cjhtf6" href="/hello-world/">← <!-- -->Hello, friend</a></li><li></li></ul></footer></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/lmc/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-f2ca6e7f064d7ce095eb.js"],"component---node-modules-gatsby-theme-blog-core-src-templates-post-query-js":["/component---node-modules-gatsby-theme-blog-core-src-templates-post-query-js-d2a146b9abdd88ed6071.js"],"component---node-modules-gatsby-theme-blog-core-src-templates-posts-query-js":["/component---node-modules-gatsby-theme-blog-core-src-templates-posts-query-js-deaf5c079417173fcd18.js"],"component---node-modules-gatsby-theme-notes-src-templates-note-js":["/component---node-modules-gatsby-theme-notes-src-templates-note-js-654de39b39a4089b4460.js"],"component---node-modules-gatsby-theme-notes-src-templates-notes-js":["/component---node-modules-gatsby-theme-notes-src-templates-notes-js-591c79df170425372ce5.js"]};/*]]>*/</script><script src="/webpack-runtime-ffe2303114af638aa29a.js" async=""></script><script src="/styles-72b9aca6a03bf971c27e.js" async=""></script><script src="/framework-f0b1095636d7eea85476.js" async=""></script><script src="/app-f2ca6e7f064d7ce095eb.js" async=""></script><script src="/commons-b68ccf6b2b9e9af58b8a.js" async=""></script><script src="/799b9e28ec84f08939ab3af68c08e0b6efc8bad3-3109dda61198b9e82a9c.js" async=""></script><script src="/component---node-modules-gatsby-theme-blog-core-src-templates-post-query-js-d2a146b9abdd88ed6071.js" async=""></script></body></html>